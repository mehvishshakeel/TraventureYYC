<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>Events - TraventureYYC</title>
  <link rel="stylesheet" href="../css/main.css">

</head>

<body>
  <div class="app-container">
    <!-- Status Bar -->
    <div class="status-bar">
      <div class="status-bar__left">
        <div class="status-bar__time">9:41</div>
      </div>
      <div class="status-bar__right">
        <div class="status-bar__signal">
          <img src="../images/mobile-signal-60.svg" alt="Signal">
        </div>
        <div class="status-bar__wifi">
          <img src="../images/wifi-59.svg" alt="WiFi">
        </div>
        <div class="status-bar__battery">
          <img src="../images/combined-shape-57.svg" alt="Battery">
          <img src="../images/rectangle-58.svg" alt="Battery">
        </div>
      </div>
    </div>

    <!-- Top Bar -->
    <div class="top-bar">
      <a href="homepage.html" style="color: var(--color-text-black); font-size: x-large;">‚Üê</a>
      <div class="top-bar__logo">
        Traventure<span class="top-bar__logo-accent">YYC</span>
      </div>
      <div class="top-bar__actions">
        <a href="signup.html"
           style="color: var(--color-primary); font-size: 14px; margin-right: var(--spacing-sm);">
          Sign up
        </a>

        <div class="language-selector">
          <button class="lang-btn">
            <span class="lang-text">ENG</span>
            <img src="../images/english-51.png" alt="English" class="flag-icon">
          </button>
          <div class="lang-menu">
            <div class="lang-option" data-lang="en">English</div>
            <div class="lang-option" data-lang="fr">Fran√ßais</div>
            <div class="lang-option" data-lang="es">Espa√±ol</div>
            <div class="lang-option" data-lang="ch">‰∏≠Êñá</div>
            <div class="lang-option" data-lang="jp">Êó•Êú¨Ë™û</div>
          </div>
        </div>
      </div>
    </div>

    <script src="../js/app.js"></script>

    <!-- Content -->
    <div class="content">
      <h1 style="font-size: 24px; font-weight: 700; margin-bottom: var(--spacing-md);">
        Calgary's Events
      </h1>

      <!-- Search Bar -->
      <div class="search-bar">
        <span>üîç</span>
        <input type="text" class="search-bar__input" placeholder="Search events...">
      </div>

          

      <!-- EVENTS LIST (Chronological from July 14 onward) -->

      <!-- 1. Calgary Stampede (Ends July 14) -->
      <div class="list-item" data-id="stampede" data-type="event">
        <img src="../images/calgarystampede.png" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">Calgary Stampede</div>
          <div class="list-item__subtitle">July 5 ‚Äì July 14</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

      <!-- 2. Zoo After Dark -->
      <div class="list-item" data-id="zoo-after-dark" data-type="event">
        <img src="../images/zooafterdark.jpg" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">Zoo After Dark</div>
          <div class="list-item__subtitle">July 18 ‚Ä¢ 6:00 PM</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

      <!-- 3. YYC Food Truck Festival -->
      <div class="list-item" data-id="food-truck-fest" data-type="event">
        <img src="../images/foodtruck.jpg" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">YYC Food Truck Festival</div>
          <div class="list-item__subtitle">July 20 ‚Ä¢ 12:00 ‚Äì 8:00 PM</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

      <!-- 4. Calgary Folk Music Festival -->
      <div class="list-item" data-id="folk-festival" data-type="event">
        <img src="../images/folkfest.jpg" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">Calgary Folk Music Festival</div>
          <div class="list-item__subtitle">July 25 ‚Äì 28</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

      <!-- 5. Calgary Marathon Expo -->
      <div class="list-item" data-id="marathon-expo" data-type="event">
        <img src="../images/marathon.jpg" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">Calgary Marathon Expo</div>
          <div class="list-item__subtitle">July 27</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

      <!-- 6. Taste of Calgary -->
      <div class="list-item" data-id="taste-of-calgary" data-type="event">
        <img src="../images/tasteofcalgary.jpg" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">Taste of Calgary</div>
          <div class="list-item__subtitle">Aug 1 ‚Äì 5</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

      <!-- 7. GlobalFest Fireworks -->
      <div class="list-item" data-id="globalfest" data-type="event">
        <img src="../images/firework.jpg" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">GlobalFest Fireworks</div>
          <div class="list-item__subtitle">Aug 15 ‚Äì 24 ‚Ä¢ 10:00 PM</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

      <!-- 8. Beyond Van Gogh (Exhibition) -->
      <div class="list-item" data-id="van-gogh" data-type="event">
        <img src="../images/vangogh.jpg" class="list-item__image">
        <div class="list-item__content">
          <div class="list-item__title">Beyond Van Gogh</div>
          <div class="list-item__subtitle">July ‚Äì August</div>
        </div>
        <div class="list-item__actions">
          <button class="event-fav-btn icon-button">‚ô°</button>
          <span class="add-to-itinerary-btn" style="font-size: 20px;">+</span>
        </div>
      </div>

    </div>

    <!-- EVENT DETAIL BOTTOM SHEET (same design as Activities) -->
    <div id="eventSheetOverlay" class="bottom-sheet-overlay">
      <div class="bottom-sheet-card">
        
        <div class="bottom-sheet-hero">
          <img id="sheetImage">

          <div class="bottom-sheet-hero-top">
            <button id="sheetBackBtn" class="bottom-sheet-back-btn">‚Üê</button>

            <div class="bottom-sheet-actions">
              <button id="sheetFavBtn" class="icon-button">‚ô°</button>
              <button id="sheetAddBtn" class="icon-button">+</button>
            </div>
          </div>

          <div class="bottom-sheet-title-wrap">
            <span id="sheetTitle" class="bottom-sheet-title"></span>
          </div>
        </div>

        <div class="bottom-sheet-body">
          <p id="sheetIntro"></p>
          <p id="sheetDate" style="font-weight:600;"></p>
          <p id="sheetDesc"></p>

          <button id="sheetLearnMoreBtn"
                  class="btn btn--primary btn--full"
                  style="margin-top: 16px;">
            Learn more ‚ûú
          </button>
        </div>

      </div>
    </div>


    <!-- UNIVERSAL UNSAVE MODAL -->
    <div id="unsaveModal" class="call-modal-overlay" style="display:none;">
      <div class="call-modal">
        <h2>Remove Favorite?</h2>
        <p>Unsave this event?</p>
        <div class="modal-btn-row">
          <button id="unsaveYesBtn" class="modal-confirm-btn">Yes</button>
          <button id="unsaveNoBtn" class="modal-cancel-btn">Cancel</button>
        </div>
      </div>
    </div>


    <!-- Bottom Navigation -->
    <div class="bottom-nav">
      <a href="itinerary.html" class="bottom-nav__item">
        <img src="../images/calendar-39.svg" class="bottom-nav__icon">
        <span class="bottom-nav__label">Itinerary</span>
      </a>
      <a href="homepage.html" class="bottom-nav__item">
        <img src="../images/home-42.svg" alt="Home" class="bottom-nav__icon">
        <span class="bottom-nav__label">Home</span>
      </a>
      <a href="emergency.html" class="bottom-nav__item">
        <img src="../images/icon-emergency-44.png" class="bottom-nav__icon">
        <span class="bottom-nav__label">Emergency</span>
      </a>
      <a href="settings.html" class="bottom-nav__item">
        <img src="../images/node-46.png" class="bottom-nav__icon">
        <span class="bottom-nav__label">Settings</span>
      </a>
    </div>
  </div>

  <script src="../js/app.js"></script>

  <!-- EVENT DETAILS DATA -->
  <script>
    const EVENT_DETAILS = {
      "stampede": {
        intro: "The Greatest Outdoor Show on Earth.",
        date: "July 5 ‚Äì July 14",
        hasFixedTime: false,
        description:
          "The Calgary Stampede features rodeos, concerts, parades, night shows, agricultural exhibits, and a massive midway.",
        learnMoreUrl: "https://www.calgarystampede.com/"
      },

      "zoo-after-dark": {
        intro: "Exclusive evening experience at Calgary Zoo.",
        date: "July 18 ‚Ä¢ 6:00 PM ‚Äì 9:00 PM",
        hasFixedTime: true,
        fixedStart: "18:00",
        fixedEnd: "21:00",
        description:
          "Enjoy zoo exhibits after hours with live music, adult beverages, and a unique night-time atmosphere.",
        learnMoreUrl: "https://www.calgaryzoo.com/"
      },

      "food-truck-fest": {
        intro: "The biggest summer food truck celebration in Calgary.",
        date: "July 20 ‚Ä¢ 12:00 ‚Äì 8:00 PM",
        hasFixedTime: true,
        fixedStart: "12:00",
        fixedEnd: "20:00",
        description:
          "Over 40 local food trucks serving international dishes, desserts, drinks, and live music throughout the day.",
        learnMoreUrl: "https://www.yycbta.com/"
      },

      "folk-festival": {
        intro: "70+ artists performing at Prince's Island Park.",
        date: "July 25 ‚Äì 28",
        hasFixedTime: false,
        description:
          "A multi-day festival featuring international musicians, artisan markets, food vendors, and stunning outdoor stages.",
        learnMoreUrl: "https://www.calgaryfolkfest.com/"
      },

      "marathon-expo": {
        intro: "Gear, wellness products, workshops, and demos.",
        date: "July 27",
        hasFixedTime: false,
        description:
          "A full-day expo for runners featuring vendors, free samples, expert talks, and marathon preparation resources.",
        learnMoreUrl: "https://www.calgarymarathon.com/"
      },

      "taste-of-calgary": {
        intro: "Taste foods from Calgary‚Äôs best restaurants.",
        date: "Aug 1 ‚Äì 5",
        hasFixedTime: false,
        description:
          "A citywide food festival offering samples from diverse cuisines, craft drinks, desserts, and entertainment.",
        learnMoreUrl: "https://www.tasteofcalgary.com/"
      },

      "globalfest": {
        intro: "International fireworks competition and night market.",
        date: "Aug 15 ‚Äì 24 ‚Ä¢ 10:00 PM",
        hasFixedTime: true,
        fixedStart: "22:00",
        fixedEnd: "22:30",
        description:
          "Teams from around the world compete with choreographed pyromusical shows, accompanied by a vibrant cultural night market.",
        learnMoreUrl: "https://www.globalfest.ca/"
      },

      "van-gogh": {
        intro: "Immersive walk-through digital art experience.",
        date: "July ‚Äì August",
        hasFixedTime: false,
        description:
          "Step inside Van Gogh‚Äôs most famous paintings with 360¬∞ projections, atmospheric soundscapes, and interactive displays.",
        learnMoreUrl: "https://www.vangoghcalgary.com/"
      }
    };

  </script>

  <script>
    // --- Favorite Storage Helpers ---
    function loadFavorites() {
      return JSON.parse(localStorage.getItem("favorites") || "[]");
    }

    function saveFavorites(list) {
      localStorage.setItem("favorites", JSON.stringify(list));
    }
  </script>

  <script>
    // Event LIST heart logic (correct version)
    document.querySelectorAll('.list-item[data-type="event"]').forEach(card => {

      const favBtn = card.querySelector('.event-fav-btn');
      const id = card.dataset.id;
      const title = card.querySelector('.list-item__title')?.textContent.trim() || "";
      const subtitle = card.querySelector('.list-item__subtitle')?.textContent.trim() || "";
      const image = card.querySelector('.list-item__image')?.src || "";

      function updateHeart() {
        const favs = loadFavorites();
        const isFav = favs.some(f => f.id === id);
        favBtn.textContent = isFav ? "‚ô•" : "‚ô°";
        favBtn.classList.toggle("is-active", isFav);
      }

      updateHeart();

      favBtn.addEventListener("click", (e) => {
        e.stopPropagation();

        let favs = loadFavorites();
        const isFav = favs.some(f => f.id === id);

        if (isFav) {
          openUnsaveModal(id, () => {
            favs = favs.filter(f => f.id !== id);
            saveFavorites(favs);
            updateHeart();
          });
        } else {
          // ADD favorite
          favs.push({
            id,
            title,
            subtitle,
            image,
            type: "event"
          });
        }
        saveFavorites(favs);
        updateHeart();
      });
    });
  </script>

  <script>
  <!-- OVERLAY LOGIC (same as attractions, adjusted for events) -->
    (function setupEventBottomSheet() {

  const overlay = document.getElementById("eventSheetOverlay");
  if (!overlay) return;

  const cardEl = overlay.querySelector(".bottom-sheet-card");

  const imgEl = document.getElementById("sheetImage");
  const titleEl = document.getElementById("sheetTitle");
  const introEl = document.getElementById("sheetIntro");
  const dateEl = document.getElementById("sheetDate");
  const descEl = document.getElementById("sheetDesc");
  const learnBtn = document.getElementById("sheetLearnMoreBtn");

  const favBtn = document.getElementById("sheetFavBtn");
  const addBtn = document.getElementById("sheetAddBtn");
  const backBtn = document.getElementById("sheetBackBtn");

  let currentId = null;

  function openSheet(card) {
    const id = card.dataset.id;
    currentId = id;

    const title = card.querySelector(".list-item__title")?.textContent.trim() ?? "";
    const img = card.querySelector(".list-item__image")?.src ?? "";
    const details = EVENT_DETAILS[id] ?? {};

    imgEl.src = img;
    titleEl.textContent = title;
    introEl.textContent = details.intro || "";
    dateEl.textContent = details.date || "";
    descEl.textContent = details.description || "";
    learnBtn.onclick = () => window.open(details.learnMoreUrl, "_blank");

    // Sync favorite state
    const favs = loadFavorites();
    const isFav = favs.some(f => f.id === id);
    favBtn.textContent = isFav ? "‚ô•" : "‚ô°";
    favBtn.classList.toggle("is-active", isFav);

    overlay.classList.add("is-visible");
  }

  // Open when clicking card
  document.querySelectorAll(".list-item[data-type='event']").forEach(card => {
    card.addEventListener("click", (e) => {
      if (e.target.closest(".list-item__actions")) return;
      openSheet(card);
    });
  });

  // Close sheet
  function closeSheet() {
    overlay.classList.remove("is-visible");
  }

  backBtn.addEventListener("click", () => {
    const fromFav = sessionStorage.getItem("cameFromFavorites");

    if (fromFav === "yes") {
      sessionStorage.removeItem("cameFromFavorites");
      window.location.href = "favorites.html";
    } else {
      closeSheet();
    }
  });

  // FAVORITE BUTTON
  favBtn.addEventListener("click", () => {
    let favs = loadFavorites();
    const isFav = favs.some(f => f.id === currentId);

    if (isFav) {
      openUnsaveModal(currentId, () => {
        favs = favs.filter(f => f.id !== currentId);
        saveFavorites(favs);

        favBtn.textContent = "‚ô°";
        favBtn.classList.remove("is-active");

        const listHeart = document.querySelector(`
          .list-item[data-id="${currentId}"] .event-fav-btn`
        );
        if (listHeart) {
          listHeart.textContent = "‚ô°";
          listHeart.classList.remove("is-active");
        }
      });

    } else {
      const card = document.querySelector(`.list-item[data-id="${currentId}"]`);

      favs.push({
        id: currentId,
        title: titleEl.textContent,
        subtitle: dateEl.textContent,
        image: imgEl.src,
        type: "event"
      });

      saveFavorites(favs);
      favBtn.textContent = "‚ô•";
      favBtn.classList.add("is-active");

      const listHeart = document.querySelector(`
        .list-item[data-id="${currentId}"] .event-fav-btn`
      );
      if (listHeart) {
        listHeart.textContent = "‚ô•";
        listHeart.classList.add("is-active");
      }
    }
  });

  // ADD to itinerary
  addBtn.addEventListener("click", () => {
    const pending = {
      title: titleEl.textContent,
      date: new Date().toISOString().slice(0, 10),
      startTime: "13:00",
      endTime: "14:00",
      location: ""
    };

    sessionStorage.setItem("pendingItineraryData", JSON.stringify(pending));
    window.location.href = "itinerary-edit.html";
  });

})();

    </script>


    <script>
    document.addEventListener("DOMContentLoaded", () => {
      const urlParams = new URLSearchParams(window.location.search);
      const openId = urlParams.get("id");
      if (!openId) return;

      // Find card with that id
      const card = document.querySelector(`.list-item[data-id="${openId}"]`);
      if (!card) return;

      // Simulate clicking the card to open overlay
      card.click();
    });
    </script>
<script>
  window.addEventListener('DOMContentLoaded', function() {
    // Find the "Sign up" link in the top bar on this page
    const signupBtn = document.querySelector('.top-bar__actions a');

    // If this page doesn't have a sign up button, do nothing
    if (!signupBtn) return;

    try {
      const stored = sessionStorage.getItem('currentUser');

      // No user stored ‚Üí show "Sign up"
      if (!stored) {
        signupBtn.style.display = 'inline-block';
        return;
      }

      const user = JSON.parse(stored);
      const isGuest =
        user.email === 'guest@guest.com' ||
        user.username === 'guest' ||
        user.name === 'Guest User';

      // Real logged-in user ‚Üí hide "Sign up"
      // Guest / test account ‚Üí still show "Sign up"
      if (isGuest) {
        signupBtn.style.display = 'inline-block';
      } else {
        signupBtn.style.display = 'none';
      }
    } catch (e) {
      // On any error, fall back to showing it
      signupBtn.style.display = 'inline-block';
    }
  });
</script>

<script src="../js/app.js"></script>

</body>
</html>
